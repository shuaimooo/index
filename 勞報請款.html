<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LUMASONIX 技術人員請款單</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f5f7fa;
            font-size: 16px;
        }
        .form-container {
            width: 210mm; /* A4 width */
            min-height: 297mm; /* A4 height */
            margin: 0 auto;
            background-color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 0;
            position: relative;
        }
        .header-black {
            background-color: #000000;
            color: white;
            padding: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        input, select {
            border: 1px solid #e2e8f0;
            padding: 0.5rem;
            border-radius: 0.25rem;
            width: 100%;
            font-size: 1.125rem;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #3a1c71;
            box-shadow: 0 0 0 3px rgba(58, 28, 113, 0.2);
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
            font-size: 1.125rem;
        }
        th {
            background-color: #f8fafc;
            font-weight: 500;
        }
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.25rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1.125rem;
        }
        .btn-primary {
            background-color: #3a1c71;
            color: white;
        }
        .btn-primary:hover {
            background-color: #2d1657;
        }
        .btn-secondary {
            background-color: #e2e8f0;
            color: #4a5568;
        }
        .btn-secondary:hover {
            background-color: #cbd5e0;
        }
        .btn-danger {
            background-color: #e53e3e;
            color: white;
        }
        .btn-danger:hover {
            background-color: #c53030;
        }
        @media print {
            body {
                background-color: white;
            }
            .form-container {
                box-shadow: none;
                margin: 0;
                padding: 0;
            }
            .no-print {
                display: none;
            }
        }
        .time-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
    </style>
</head>
<body>
    <div class="form-container my-8">
        <div class="header-black">
            <div class="text-left">
                <h1 class="text-3xl font-bold">LUMASONIX x PROFESSIONAL</h1>
                <p class="text-xl mt-2">專業技術支援 x 人力媒合行銷</p>
            </div>
            <div class="text-right">
                <h2 class="text-3xl font-bold">技術人員請款單</h2>
            </div>
        </div>

        <form id="invoiceForm" class="p-6">
            <!-- 基本資訊 -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div>
                    <label class="block text-xl font-medium text-gray-700 mb-1">廠商名稱</label>
                    <input type="text" id="vendorName" placeholder="請輸入廠商名稱" class="w-full text-xl">
                </div>
                <div>
                    <label class="block text-xl font-medium text-gray-700 mb-1">活動地點</label>
                    <input type="text" id="eventLocation" placeholder="請輸入活動地點" class="w-full text-xl">
                </div>
            </div>

           <!-- 時間資訊 -->
            <div class="bg-gray-50 p-4 rounded-lg mb-6">
                <div class="grid grid-cols-2 gap-4">
                    <!-- 左側：上班時間 -->
                    <div>
                        <label class="block text-xl font-medium text-gray-700 mb-2">上班時間</label>
                        <div class="flex items-center gap-1 mb-3">
                            <input type="text" id="startYear1" class="w-12 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="4" placeholder="">
                            <span class="text-sm">年</span>
                            <input type="text" id="startMonth1" class="w-10 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="2" placeholder="">
                            <span class="text-sm">月</span>
                            <input type="text" id="startDay1" class="w-10 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="2" placeholder="">
                            <span class="text-sm">日</span>
                            <input type="text" id="startHour1" class="w-10 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="2" placeholder="">
                            <span class="text-sm">時</span>
                            <input type="text" id="startMinute1" class="w-10 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="2" placeholder="">
                            <span class="text-sm">分</span>
                            <span class="text-sm ml-2">至</span>
                        </div>
                        <div class="flex items-center gap-1">
                            <input type="text" id="startYear2" class="w-12 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="4" placeholder="">
                            <span class="text-SM">年</span>
                            <input type="text" id="startMonth2" class="w-10 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="2" placeholder="">
                            <span class="text-sm">月</span>
                            <input type="text" id="startDay2" class="w-10 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="2" placeholder="">
                            <span class="text-sm">日</span>
                            <input type="text" id="startHour2" class="w-10 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="2" placeholder="">
                            <span class="text-sm">時</span>
<input type="text" id="startHour2" class="w-10 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="2" placeholder="">
                            
                            <span class="text-sm">分</span>
<span class="text-sm ml-2">至</span>

                            
                        </div>
                    </div>
                    
                    <!-- 右側：下班時間 -->
                    <div>
                        <label class="block text-xl font-medium text-gray-700 mb-2">下班時間</label>
                       <div class="flex items-center gap-1 mb-3">
                            <input type="text" id="startYear1" class="w-10 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="4" placeholder="">
                            <span class="text-sm">年</span>
                            <input type="text" id="startMonth1" class="w-10 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="2" placeholder="">
                            <span class="text-sm">月</span>
                            <input type="text" id="startDay1" class="w-10 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="2" placeholder="">
                            <span class="text-sm">日</span>
                            <input type="text" id="startHour1" class="w-10 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="2" placeholder="">
                            <span class="text-sm">時</span>
                            <input type="text" id="startMinute1" class="w-10 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="2" placeholder="">
                            <span class="text-sm">分</span>
                            
                        </div>
                        <div class="flex items-center gap-1">
                            <input type="text" id="startYear2" class="w-10 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="4" placeholder="">
                            <span class="text-SM">年</span>
                            <input type="text" id="startMonth2" class="w-10 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="2" placeholder="">
                            <span class="text-sm">月</span>
                            <input type="text" id="startDay2" class="w-10 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="2" placeholder="">
                            <span class="text-sm">日</span>
                            <input type="text" id="startHour2" class="w-10 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="2" placeholder="">
                            <span class="text-sm">時</span>
<input type="text" id="startHour2" class="w-10 h-8 px-2 py-1 border border-gray-300 rounded text-center text-sm" maxlength="2" placeholder="">
                            
                            <span class="text-sm">分</span>
                          
                        
                    </div></div>
                </div>
            </div>


            <!-- 活動支援明細 -->
            <div class="mb-6">
                <h3 class="text-xl font-medium mb-3">活動支援明細</h3>
                <div class="overflow-x-auto">
                    <table class="min-w-full">
                        <thead>
                            <tr>
                                <th class="text-xl">品項</th>
                                <th class="text-xl">數量</th>
                                <th class="text-xl">單價 (NT$)</th>
                                <th class="text-xl">工作內容</th>
                                <th class="text-xl">小計 (NT$)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="text-xl">人事支援</td>
                                <td><input type="number" id="staffCount" value="0" min="0" class="w-20 text-xl"></td>
                                <td class="text-xl">2,500</td>
                                <td class="text-xl">進場、演出、撤場</td>
                                <td id="staffTotal" class="text-xl">0.0</td>
                            </tr>
                            <tr>
                                <td class="text-xl">燈/音/視控</td>
                                <td><input type="number" id="techCount" value="0" min="0" class="w-20 text-xl"></td>
                                <td class="text-xl">1,000</td>
                                <td class="text-xl">演出前一日彩排，將視為一場演出，另行計費。</td>
                                <td id="techTotal" class="text-xl">0.0</td>
                            </tr>
                            <tr>
                                <td class="text-xl">追光燈操作</td>
                                <td><input type="number" id="spotlightCount" value="0" min="0" class="w-20 text-xl"></td>
                                <td class="text-xl">1,000</td>
                                <td class="text-xl">演出前一日彩排，將視為一場演出，另行計費。</td>
                                <td id="spotlightTotal" class="text-xl">0.0</td>
                            </tr>
                            <tr>
                                <td class="text-xl">高空作業</td>
                                <td><input type="number" id="heightCount" value="0" min="0" class="w-20 text-xl"></td>
                                <td class="text-xl">1,000</td>
                                <td class="text-xl">作業高度達layher第 6 格以上(約9米)</td>
                                <td id="heightTotal" class="text-xl">0.0</td>
                            </tr>
                            <tr>
                                <td class="text-xl">加班費用</td>
                                <td><input type="number" id="overtimeCount" value="0" min="0" class="w-20 text-xl"></td>
                                <td class="text-xl">350</td>
                                <td class="text-xl">依實際加班時數計算</td>
                                <td id="overtimeTotal" class="text-xl">0.0</td>
                            </tr>
                            <tr>
                                <td class="text-xl">行政執行費</td>
                                <td class="text-xl">一式</td>
                                <td class="text-xl">10%</td>
                                <td class="text-xl">人事支援 x 10%</td>
                                <td id="adminTotal" class="text-xl">0.0</td>
                            </tr>
                            <tr>
                                <td class="text-xl">其他</td>
                                <td class="text-xl">一式</td>
                                <td><input type="number" id="otherPrice" value="0" min="0" class="w-20 text-xl"></td>
                                <td><input type="text" id="otherDesc" placeholder="其他項目描述" class="w-full text-xl"></td>
                                <td id="otherTotal" class="text-xl">0.0</td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr class="font-medium">
                                <td colspan="4" class="text-right text-xl">未稅金額:</td>
                                <td id="subtotal" class="text-xl">NT$0.0</td>
                            </tr>
                            <tr class="font-bold">
                                <td colspan="4" class="text-right text-xl">總計金額:</td>
                                <td id="total" class="text-xl">NT$0.0</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>

           <!-- 匯款資訊 -->
            <div class="bg-gray-50 p-4 rounded-lg mb-6">
                <h3 class="text-xl font-medium mb-2">【匯款資訊】</h3>
                <p class="text-xl">帳號戶名：蘇裕庭</p>
                <p class="text-xl">匯款代碼：808(玉山銀行中路特區分行)</p>
                <p class="text-xl">匯款帳號：0842-979-176643</p>

            </div>

            <!-- 勞報資料檢附 -->
            <div class="mb-6">
                <h3 class="text-xl font-medium mb-3">勞報資料檢附</h3>
                <div id="laborReportContainer">
                    <!-- 第一位人員 -->
                    <div class="labor-person bg-gray-50 p-4 rounded-lg mb-4">
                        <div class="grid grid-cols-4 gap-4 mb-3">
                            <div>
                                <label class="block text-xl font-medium text-gray-700 mb-1">人員姓名</label>
                                <input type="text" placeholder="請輸入姓名" class="w-full text-xl">
                            </div>
                            <div>
                                <label class="block text-xl font-medium text-gray-700 mb-1">出生年月日</label>
                                <input type="text" placeholder="例：1990/01/01" class="w-full text-xl">
                            </div>
                            <div>
                                <label class="block text-xl font-medium text-gray-700 mb-1">身分證字號</label>
                                <input type="text" placeholder="請輸入身分證字號" class="w-full text-xl">
                            </div>
                            <div>
                                <label class="block text-xl font-medium text-gray-700 mb-1">連絡電話</label>
                                <input type="text" placeholder="請輸入電話" class="w-full text-xl">
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xl font-medium text-gray-700 mb-1">戶籍地址</label>
                                <input type="text" placeholder="戶籍地址" class="w-full text-xl">
                            </div>
                            <div>
                                <label class="block text-xl font-medium text-gray-700 mb-1">勞報金額</label>
                                <div class="flex items-center">
                                    <input type="number" placeholder="勞報金額" class="w-full text-xl">
                                    <span class="ml-2 text-xl">元</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 第二位人員 -->
                    <div class="labor-person bg-gray-50 p-4 rounded-lg mb-4">
                        <div class="grid grid-cols-4 gap-4 mb-3">
                            <div>
                                <label class="block text-xl font-medium text-gray-700 mb-1">人員姓名</label>
                                <input type="text" placeholder="請輸入姓名" class="w-full text-xl">
                            </div>
                            <div>
                                <label class="block text-xl font-medium text-gray-700 mb-1">出生年月日</label>
                                <input type="text" placeholder="例：1990/01/01" class="w-full text-xl">
                            </div>
                            <div>
                                <label class="block text-xl font-medium text-gray-700 mb-1">身分證字號</label>
                                <input type="text" placeholder="請輸入身分證字號" class="w-full text-xl">
                            </div>
                            <div>
                                <label class="block text-xl font-medium text-gray-700 mb-1">連絡電話</label>
                                <input type="text" placeholder="請輸入電話" class="w-full text-xl">
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xl font-medium text-gray-700 mb-1">戶籍地址</label>
                                <input type="text" placeholder="戶籍地址" class="w-full text-xl">
                            </div>
                            <div>
                                <label class="block text-xl font-medium text-gray-700 mb-1">勞報金額</label>
                                <div class="flex items-center">
                                    <input type="number" placeholder="勞報金額" class="w-full text-xl">
                                    <span class="ml-2 text-xl">元</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <button type="button" id="addPersonBtn" class="btn btn-secondary mt-2">
                    + 新增人員
                </button>
            </div>

            <!-- 備註 -->
            <div class="mb-6">
                <label class="block text-xl font-medium text-gray-700 mb-1">備註</label>
                <textarea id="notes" rows="3" placeholder="請輸入備註事項..." class="w-full border rounded-md p-2 text-xl"></textarea>
            </div>

            <!-- 聯絡資訊 -->
            <div class="bg-gray-50 p-4 rounded-lg mb-6">
                <h3 class="text-xl font-medium mb-2">聯絡資訊</h3>
                <p class="text-xl">負責人：蘇裕庭</p>
                <p class="text-xl">連絡電話：0926169899</p>
            </div>

            <!-- 按鈕區域 -->
            <div class="flex justify-center space-x-4 mt-8 no-print">
                <button type="button" id="generatePdfBtn" class="btn btn-primary text-xl px-6">
                    下載生成PDF
                </button>
                <button type="button" id="setDateBtn" class="btn btn-secondary text-xl px-6">
                    設置日期
                </button>
                <button type="button" id="resetFormBtn" class="btn btn-danger text-xl px-6">
                    重置表單
                </button>
            </div>
        </form>

        <div class="bg-gray-100 p-4 text-center text-xl text-gray-600">
            <p>LUMASONIX x PROFESSIONAL | 專業技術支援 x 人力媒合行銷</p>
            <p>電話: 0926-169-899 | 電子郵件: lumasonix@gmail.com</p>
        </div>
    </div>

   <script>
        // 設置當前日期作為默認值
        function setCurrentDate() {
            const now = new Date();
            const year = now.getFullYear();
            const month = (now.getMonth() + 1).toString().padStart(2, '0');
            const day = now.getDate().toString().padStart(2, '0');
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            
            // 設置上班時間1
            document.getElementById('startYear1').value = year;
            document.getElementById('startMonth1').value = month;
            document.getElementById('startDay1').value = day;
            document.getElementById('startHour1').value = hours;
            document.getElementById('startMinute1').value = minutes;
            
            // 設置上班時間2
            document.getElementById('startYear2').value = year;
            document.getElementById('startMonth2').value = month;
            document.getElementById('startDay2').value = day;
            document.getElementById('startHour2').value = hours;
            document.getElementById('startMinute2').value = minutes;
            
            // 設置下班時間1
            document.getElementById('endYear1').value = year;
            document.getElementById('endMonth1').value = month;
            document.getElementById('endDay1').value = day;
            document.getElementById('endHour1').value = hours;
            document.getElementById('endMinute1').value = minutes;
            
            // 設置下班時間2
            document.getElementById('endYear2').value = year;
            document.getElementById('endMonth2').value = month;
            document.getElementById('endDay2').value = day;
            document.getElementById('endHour2').value = hours;
            document.getElementById('endMinute2').value = minutes;
            
            // 設置請款日期
            document.getElementById('invoiceYear').value = year;
            document.getElementById('invoiceMonth').value = month;
            document.getElementById('invoiceDay').value = day;
            document.getElementById('invoiceHour').value = hours;
            document.getElementById('invoiceMinute').value = minutes;
            
            alert('已設置為當前日期！');
        }
        
        // 計算金額
        function calculateTotals() {
            const staffCount = parseInt(document.getElementById('staffCount').value) || 0;
            const techCount = parseInt(document.getElementById('techCount').value) || 0;
            const spotlightCount = parseInt(document.getElementById('spotlightCount').value) || 0;
            const heightCount = parseInt(document.getElementById('heightCount').value) || 0;
            const overtimeCount = parseInt(document.getElementById('overtimeCount').value) || 0;
            const otherPrice = parseInt(document.getElementById('otherPrice').value) || 0;
            
            const staffTotal = staffCount * 2500;
            const techTotal = techCount * 1000;
            const spotlightTotal = spotlightCount * 1000;
            const heightTotal = heightCount * 1000;
            const overtimeTotal = overtimeCount * 350;
            const adminTotal = staffTotal * 0.1;
            const otherTotal = otherPrice;
            
            document.getElementById('staffTotal').textContent = staffTotal.toLocaleString();
            document.getElementById('techTotal').textContent = techTotal.toLocaleString();
            document.getElementById('spotlightTotal').textContent = spotlightTotal.toLocaleString();
            document.getElementById('heightTotal').textContent = heightTotal.toLocaleString();
            document.getElementById('overtimeTotal').textContent = overtimeTotal.toLocaleString();
            document.getElementById('adminTotal').textContent = adminTotal.toLocaleString();
            document.getElementById('otherTotal').textContent = otherTotal.toLocaleString();
            
            const subtotal = staffTotal + techTotal + spotlightTotal + heightTotal + overtimeTotal + adminTotal + otherTotal;
            document.getElementById('subtotal').textContent = `NT$${subtotal.toLocaleString()}`;
            document.getElementById('total').textContent = `NT$${subtotal.toLocaleString()}`;
        }
        
        // 重置表單
        function resetForm() {
            if (confirm('確定要重置表單嗎？所有已填寫的資料將被清空。')) {
                // 重置表單輸入
                const inputs = document.querySelectorAll('input[type="text"], input[type="number"], textarea');
                inputs.forEach(input => {
                    input.value = '';
                });
                
                // 重置計算
                document.getElementById('staffCount').value = 0;
                document.getElementById('techCount').value = 0;
                document.getElementById('spotlightCount').value = 0;
                document.getElementById('heightCount').value = 0;
                document.getElementById('overtimeCount').value = 0;
                document.getElementById('otherPrice').value = 0;
                calculateTotals();
                
                // 設置當前日期
                setCurrentDate();
                
                // 清除勞報人員資料，只保留前兩個
                const container = document.getElementById('laborReportContainer');
                const persons = container.querySelectorAll('.labor-person');
                
                // 保留前兩個，刪除其餘的
                for (let i = 2; i < persons.length; i++) {
                    container.removeChild(persons[i]);
                }
                
                alert('表單已重置！');
            }
        }
        
        // 生成PDF
        function generatePDF() {
            // 隱藏按鈕區域
            const buttons = document.querySelectorAll('.no-print');
            buttons.forEach(btn => {
                btn.style.display = 'none';
            });
            
            // 使用html2canvas和jsPDF生成PDF
            html2canvas(document.querySelector('.form-container'), {
                scale: 1,
                useCORS: true,
                logging: false
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jspdf.jsPDF('p', 'mm', 'a4');
                const imgWidth = 210; // A4寬度
                const pageHeight = 297; // A4高度
                const imgHeight = canvas.height * imgWidth / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;
                
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }
                
                // 生成檔案名稱
                const now = new Date();
                const fileName = `LUMASONIX_請款單_${now.getFullYear()}${(now.getMonth()+1).toString().padStart(2, '0')}${now.getDate().toString().padStart(2, '0')}.pdf`;
                
                pdf.save(fileName);
                
                // 恢復按鈕顯示
                buttons.forEach(btn => {
                    btn.style.display = 'flex';
                });
            });
        }
        
        // 新增人員
        function addPerson() {
            const container = document.getElementById('laborReportContainer');
            const personTemplate = `
                <div class="labor-person bg-gray-50 p-4 rounded-lg mb-4">
                    <div class="grid grid-cols-4 gap-4 mb-3">
                        <div>
                            <label class="block text-xl font-medium text-gray-700 mb-1">人員姓名</label>
                            <input type="text" placeholder="請輸入姓名" class="w-full text-xl">
                        </div>
                        <div>
                            <label class="block text-xl font-medium text-gray-700 mb-1">出生年月日</label>
                            <input type="text" placeholder="例：1990/01/01" class="w-full text-xl">
                        </div>
                        <div>
                            <label class="block text-xl font-medium text-gray-700 mb-1">身分證字號</label>
                            <input type="text" placeholder="請輸入身分證字號" class="w-full text-xl">
                        </div>
                        <div>
                            <label class="block text-xl font-medium text-gray-700 mb-1">連絡電話</label>
                            <input type="text" placeholder="請輸入電話" class="w-full text-xl">
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-xl font-medium text-gray-700 mb-1">戶籍地址</label>
                            <input type="text" placeholder="戶籍地址" class="w-full text-xl">
                        </div>
                        <div>
                            <label class="block text-xl font-medium text-gray-700 mb-1">勞報金額</label>
                            <div class="flex items-center">
                                <input type="number" placeholder="勞報金額" class="w-full text-xl">
                                <span class="ml-2 text-xl">元</span>
                            </div>
                        </div>
                        <div class="flex justify-end items-center mt-2">
                            <button type="button" onclick="this.parentNode.parentNode.parentNode.remove()" class="text-red-500 hover:text-red-700 text-xl">
                                移除
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = personTemplate;
            container.appendChild(tempDiv.firstElementChild);
        }
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 設置當前日期
            setCurrentDate();
            
            // 初始計算
            calculateTotals();
            
            // 監聽數量變化
            document.getElementById('staffCount').addEventListener('input', calculateTotals);
            document.getElementById('techCount').addEventListener('input', calculateTotals);
            document.getElementById('spotlightCount').addEventListener('input', calculateTotals);
            document.getElementById('heightCount').addEventListener('input', calculateTotals);
            document.getElementById('overtimeCount').addEventListener('input', calculateTotals);
            document.getElementById('otherPrice').addEventListener('input', calculateTotals);
            
            // 新增人員按鈕
            document.getElementById('addPersonBtn').addEventListener('click', addPerson);
            
            // 限制只能輸入數字
            const numberInputs = document.querySelectorAll('input[maxlength]');
            numberInputs.forEach(input => {
                input.addEventListener('input', function() {
                    this.value = this.value.replace(/[^\d]/g, '');
                });
            });
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'94a7bba9815ade77',t:'MTc0OTA0MzI4My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
